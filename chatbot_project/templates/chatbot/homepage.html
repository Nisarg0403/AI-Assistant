<!DOCTYPE html>
{% load static %}
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CONVERSA - Smart Chatbot with Voice Interaction</title>
    <link rel="icon" type="image/x-icon" href="{% static 'images/img.png' %}">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.2/anime.min.js"></script>
    <style>
        :root {
            /* Primary Colors */
            --bg-primary: #F8F7F2; /* Off-White/Cream - Clean background */
            --brand-purple: #5D3FD3; /* Deep Purple - Main brand color */

            /* Secondary Colors */
            --text-primary: #2D2D2D; /* Soft Black - Text and UI elements */
            --accent-blue: #4285F4; /* Accent Blue - Secondary highlights */

            /* Accent Colors */
            --cta-yellow: #FFCB47; /* Warm Yellow - CTA buttons and highlights */
            --bg-secondary: #E9E9E9; /* Light Gray - Cards and dividers */
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Inter', sans-serif;
            transition: all 0.3s ease;
        }

        body {
            background: var(--bg-primary);
            color: var(--text-primary);
            min-height: 100vh;
            overflow-x: hidden;
            visibility: visible;
            position: relative; /* Ensure body context for z-index */
        }

        body * {
            visibility: visible;
            opacity: 1;
        }

        .scroll-progress {
            position: fixed;
            top: 0;
            left: 0;
            width: 0;
            height: 4px;
            background: var(--brand-purple);
            z-index: 1002;
        }

        nav {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px 5%;
            background: rgba(248, 247, 242, 0.95);
            backdrop-filter: blur(10px);
            box-shadow: 0 2px 20px rgba(0, 0, 0, 0.05);
            position: fixed;
            width: 100%;
            top: 0;
            z-index: 1001;
        }

        .logo {
            font-family: 'Poppins', sans-serif;
            font-size: clamp(1.5rem, 4vw, 1.8rem);
            font-weight: 600;
            color: var(--brand-purple);
            letter-spacing: 2px;
            animation: fadeIn 0.5s ease;
            position: relative;
        }

        .logo::after {
            content: '';
            position: absolute;
            bottom: -5px;
            left: 0;
            width: 100%;
            height: 2px;
            background: linear-gradient(90deg, var(--brand-purple), var(--accent-blue));
            transform: scaleX(0);
            transform-origin: right;
            transition: transform 0.3s ease;
        }

        .logo:hover::after {
            transform: scaleX(1);
            transform-origin: left;
        }

        nav ul {
            list-style: none;
            display: flex;
            align-items: center;
        }

        nav ul li {
            margin: 0 15px;
        }

        nav ul li a {
            text-decoration: none;
            color: var(--text-primary);
            font-weight: 500;
            padding: 8px 16px;
            font-size: clamp(0.9rem, 2.5vw, 1rem);
            position: relative;
            transition: all 0.3s ease;
        }

        nav ul li a::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            width: 100%;
            height: 2px;
            background: var(--brand-purple);
            transform: scaleX(0);
            transform-origin: right;
            transition: transform 0.3s ease;
        }

        nav ul li a:hover::after {
            transform: scaleX(1);
            transform-origin: left;
        }

        nav ul li a:hover {
            text-decoration: underline;
            color: var(--brand-purple);
        }

        .menu-toggle {
            display: none;
            flex-direction: column;
            cursor: pointer;
        }

        .menu-toggle div {
            width: 30px;
            height: 3px;
            background: var(--brand-purple);
            margin: 5px 0;
            border-radius: 3px;
        }

        section {
            padding: clamp(40px, 8vw, 60px) 5%;
            background: var(--bg-primary);
        }

        section h2 {
            font-family: 'Poppins', sans-serif;
            font-size: clamp(1.8rem, 5vw, 2.5rem);
            color: var(--brand-purple);
            margin-bottom: 30px;
            text-align: center;
        }

        .hero {
            display: grid;
            grid-template-columns: 2fr 1fr;
            align-items: center;
            padding: clamp(80px, 15vh, 100px) 5%;
            min-height: 100vh;
            position: relative;
            overflow: visible; /* Change from overflow: hidden */
            background: linear-gradient(135deg, rgba(93, 63, 211, 0.05), rgba(66, 133, 244, 0.05));
        }

        .hero::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-image:
                linear-gradient(var(--brand-purple) 1px, transparent 1px),
                linear-gradient(90deg, var(--brand-purple) 1px, transparent 1px);
            background-size: 20px 20px;
            opacity: 0.05;
            pointer-events: none;
        }

        .hero-content {
            position: relative;
            z-index: 2;
            animation: fadeInUp 1s ease;
        }

        .hero h1 {
            font-family: 'Poppins', sans-serif;
            font-size: clamp(2rem, 6vw, 3rem);
            color: var(--text-primary);
            margin-bottom: 1.5rem;
            letter-spacing: 1px;
            background: linear-gradient(135deg, var(--brand-purple), var(--accent-blue));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .hero p {
            font-size: clamp(1rem, 3vw, 1.2rem);
            max-width: 600px;
            margin-bottom: 30px;
            color: var (--text-primary);
            font-weight: 400;
            line-height: 1.8;
            opacity: 0.9;
        }

        .hero-btns {
            display: flex;
            gap: 20px;
        }

        .hero button {
            padding: 12px 25px;
            border: none;
            border-radius: 25px;
            font-size: clamp(0.9rem, 2.5vw, 1rem);
            font-weight: 600;
            text-transform: uppercase;
            cursor: pointer;
            background: var(--cta-yellow);
            color: var(--text-primary);
            position: relative;
            overflow: hidden;
        }

        .hero button::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
            transition: 0.5s;
        }

        .hero button:hover::before {
            left: 100%;
        }

        .hero button:hover {
            transform: scale(1.05);
        }

        .hero button:last-child {
            background: transparent;
            border: 2px solid var(--brand-purple);
            color: var(--brand-purple);
        }

        .hero button:last-child:hover {
            background: var(--brand-purple);
            color: var(--bg-primary);
        }

        #hero-chat-preview {
            max-width: 300px;
            background: var(--bg-primary);
            border-radius: 20px;
            padding: 20px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
            border: 1px solid rgba(93, 63, 211, 0.1);
            position: relative;
            z-index: 2;
            margin-left: auto;
            margin-right: 5%;
            animation: chatPreview 0.5s ease-out forwards, floatUpDown 3s ease-in-out infinite;
            opacity: 0;
            transform: translateY(20px);
        }

@keyframes floatVertical {
    0% {
        transform: translateY(0);
        box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
    }
    50% {
        transform: translateY(-20px);
        box-shadow: 0 30px 50px rgba(0, 0, 0, 0.15);
    }
    100% {
        transform: translateY(0);
        box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
    }
}

/* Update hover effect */
#hero-chat-preview:hover {
    transform: translateY(-10px);
    box-shadow: 0 30px 50px rgba(0, 0, 0, 0.15);
}

/* Mobile responsiveness */
@media (max-width: 768px) {
    #hero-chat-preview {
        max-width: 280px;
        margin: 2rem auto;
        transform: none;
        animation: fadeInUp 0.5s ease forwards;
        animation-delay: 0.5s;
    }

    #hero-chat-preview:hover {
        transform: translateY(-5px);
    }
}

        .preview-message {
            opacity: 0;
            transform: translateY(10px);
            margin-bottom: 15px;
            animation: messageAppear 0.5s ease forwards;
        }

        .preview-message:last-child {
            margin-bottom: 0; /* Remove margin from last message */
        }

        .preview-message.message {
            display: flex;
            align-items: flex-start;
            gap: 10px;
        }

        /* Show messages after animation */
        .preview-message.loaded {
            opacity: 1;
            transform: translateY(0);
            visibility: visible;
        }

        .preview-message.message.user {
            flex-direction: row-reverse;
        }

        .preview-message .message-content {
            padding: 10px 15px;
            border-radius: 15px;
            background: var(--bg-secondary);
            max-width: 80%;
        }

        .preview-message.user .message-content {
            background: var(--brand-purple);
            color: var(--bg-primary);
        }

        .preview-message .message-icon {
            width: 30px;
            height: 30px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            background: var(--brand-purple);
            color: var(--bg-primary);
        }

        .overview, .objectives, .how-it-works, .why-conversa, .testimonials, .cta {
            text-align: center;
        }

        .overview-summary, .overview-details {
            font-size: clamp(0.9rem, 2.5vw, 1.1rem);
            max-width: 800px;
            margin: 0 auto 20px;
            color: var(--text-primary);
            overflow: hidden;
        }

        .read-more {
            padding: 10px 20px;
            border-radius: 25px;
            background: var(--brand-purple);
            color: var(--bg-primary);
            border: none;
            cursor: pointer;
            font-weight: 600;
            text-transform: uppercase;
        }

        .read-more:hover {
            background: var(--cta-yellow);
            color: var(--text-primary);
            transform: scale(1.05);
        }

        .objective-list, .how-it-works-grid {
            display: flex;
            flex-wrap: wrap;
            gap: 25px;
            justify-content: center;
        }

        .objective-item, .works-item {
            width: clamp(200px, 45%, 300px);
            background: var(--bg-secondary);
            border: 1px solid var(--bg-secondary);
            border-radius: 10px;
            padding: 20px;
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }

        .objective-item:hover, .works-item:hover {
            transform: translateY(-5px);
            box-shadow: 0 6px 15px rgba(0, 0, 0, 0.1);
        }

        .objective-item h3, .works-item h3 {
            font-family: 'Poppins', sans-serif;
            font-size: clamp(1rem, 3vw, 1.2rem);
            color: var(--brand-purple);
            margin-bottom: 10px;
        }

        .objective-item p, .works-item p {
            font-size: clamp(0.8rem, 2vw, 0.9rem);
            color: var(--text-primary);
        }

        .works-item i {
            font-size: clamp(1.5rem, 4vw, 2rem);
            color: var(--brand-purple);
            margin-bottom: 15px;
        }

        .why-conversa p {
            max-width: 600px;
            margin: 0 auto;
            font-size: clamp(0.9rem, 2.5vw, 1.1rem);
            color: var(--text-primary);
        }

        .cta {
            position: relative;
            background: linear-gradient(135deg, var(--brand-purple), var(--accent-blue));
            padding: 6rem 0;
            color: var(--bg-primary);
            overflow: hidden;
            z-index: 1;
        }

        .cta-content {
            position: relative;
            z-index: 2;
            padding: 0 20px;
            max-width: 800px;
            margin: 0 auto;
            text-align: center;
        }

        .cta h2 {
            color: var(--bg-primary);
            margin-bottom: 1.5rem;
            font-size: clamp(2rem, 5vw, 2.5rem);
        }

        .cta-description {
            font-size: clamp(1rem, 2.5vw, 1.2rem);
            margin-bottom: 2rem;
            opacity: 0.9;
            max-width: 600px;
            margin-left: auto;
            margin-right: auto;
        }

        .prototype-badge {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 10px;
            padding: 1rem 2rem;
            margin-bottom: 3rem;
            display: inline-block;
            font-weight: 500;
        }

        .cta-form {
            position: relative;
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 15px;
            padding: 2rem;
            max-width: 500px;
            margin: 0 auto;
        }

        .cta-form input {
            width: 100%;
            padding: 1rem 1.5rem;
            border: none;
            border-radius: 8px;
            background: rgba(255, 255, 255, 0.95);
            color: var(--text-primary);
            font-size: 1rem;
            margin-bottom: 1rem;
            transition: all 0.3s ease;
        }

        .cta-form input:focus {
            outline: none;
            box-shadow: 0 0 0 3px rgba(255, 255, 255, 0.3);
        }

        .cta-form button {
            width: 100%;
            padding: 1rem 2rem;
            border: none;
            border-radius: 8px;
            background: var(--cta-yellow);
            color: var(--text-primary);
            font-weight: 600;
            font-size: 1rem;
            cursor: pointer;
            transition: all 0.3s ease;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .cta-form button:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.2);
        }

        #chatbot-widget {
            position: fixed;
            bottom: 20px;
            right: 20px;
            width: clamp(50px, 10vw, 60px);
            height: clamp(50px, 10vw, 60px);
            background: var(--brand-purple);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            animation: pulse 2s infinite;
            z-index: 1003; /* Higher than footer (1000) */
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.1); }
        }

        #chatbot-widget:hover {
            transform: scale(1.1);
        }

        #chatbot-widget i {
            font-size: clamp(1.5rem, 4vw, 2rem);
            color: var(--bg-primary);
        }

        #chatbot-box {
            display: none;
            position: fixed;
            bottom: 90px; /* Increased to avoid footer overlap */
            right: 20px;
            width: clamp(300px, 90vw, 400px);
            height: clamp(400px, 80vh, 500px);
            background: var(--bg-primary);
            border-radius: 20px;
            flex-direction: column;
            overflow: hidden;
            z-index: 1003; /* Higher than footer */
        }

        #chatbot-box.active {
            display: flex;
        }

        .chat-header {
            padding: 10px 20px;
            background: var(--brand-purple);
            color: var(--bg-primary);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .chat-header .minimize-btn, .chat-header .close-btn {
            background: none;
            border: none;
            color: var(--bg-primary);
            font-size: 1.2rem;
            cursor: pointer;
        }

        .chat-messages {
            flex: 1;
            overflow-y: auto;
            padding: 20px;
            scroll-behavior: smooth;
        }

        .message {
            display: flex;
            align-items: flex-start;
            margin-bottom: 20px;
            animation: fadeIn 0.3s ease;
        }

        .message.user {
            flex-direction: row-reverse;
        }

        .message-content {
            max-width: 70%;
            padding: 12px 16px;
            border-radius: 15px;
            margin: 0 10px;
            background: var(--bg-secondary);
            color: var (--text-primary);
        }

        .user .message-content {
            background: var(--brand-purple);
            color: var(--bg-primary);
        }

        .message-content::after {
            content: attr(data-timestamp);
            display: block;
            font-size: clamp(0.6rem, 1.5vw, 0.7rem);
            color: var(--text-primary);
            margin-top: 5px;
            text-align: right;
        }

        .message-icon {
            width: 35px;
            height: 35px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
            background: var(--brand-purple);
            color: var(--bg-primary);
        }

        .input-container {
            padding: 15px;
            background: var(--bg-secondary);
            position: sticky;
            bottom: 0;
        }

        .input-box {
            display: flex;
            gap: 10px;
            align-items: center;
        }

        input {
            flex: 1;
            padding: 12px 16px;
            border: 1px solid var(--bg-secondary);
            border-radius: 10px;
            background: var(--bg-primary);
            color: var(--text-primary);
        }

        button.send-btn {
            padding: 12px 24px;
            border: none;
            border-radius: 25px;
            background: var(--cta-yellow);
            color: var (--text-primary);
            font-weight: 600;
            cursor: pointer;
        }

        button.send-btn:hover {
            transform: scale(1.05);
        }

        .mic-btn {
            background: none;
            border: none;
            color: var(--text-primary);
            font-size: clamp(1.2rem, 3vw, 1.5rem);
            cursor: pointer;
        }

        .mic-btn.active {
            color: var(--cta-yellow);
        }

        .mic-btn.listening::after {
            content: 'Listening...';
            font-size: 0.8rem;
            color: var (--cta-yellow);
            position: absolute;
            top: -20px;
            left: 50%;
            transform: translateX(-50%);
        }

        .faq-toggle {
            padding: 8px 16px;
            background: var (--accent-blue);
            color: var (--bg-primary);
            border: none;
            border-radius: 25px;
            cursor: pointer;
            margin: 10px 0;
            width: 100%;
        }

        .faq-toggle:hover {
            background: var(--cta-yellow);
            color: var(--text-primary);
        }

        .faq-buttons {
            display: none;
            padding: 10px 20px;
            flex-wrap: wrap;
            gap: 10px;
            background: var(--bg-secondary);
            justify-content: center;
        }

        .faq-buttons.active {
            display: flex;
        }

        .faq-btn, .child-faq-btn {
            padding: 8px 16px;
            background: var (--accent-blue);
            color: var (--bg-primary);
            border: none;
            border-radius: 20px;
            font-size: clamp(12px, 2vw, 14px);
            cursor: pointer;
        }

        .faq-btn:hover, .child-faq-btn:hover {
            background: var(--cta-yellow);
            color: var(--text-primary);
        }

        .child-faq-buttons {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-top: 10px;
        }

        .contact-link {
            color: var(--accent-blue);
            text-decoration: none;
        }

        .contact-link:hover {
            color: var (--cta-yellow);
        }

        .error-notice {
            background: var(--cta-yellow);
            color: var(--text-primary);
            padding: 10px;
            border-radius: 5px;
            margin: 10px auto;
            max-width: 90%;
            text-align: center;
            font-size: clamp(0.8rem, 2vw, 1rem);
        }

        @media (max-width: 1024px) {
            .hero { grid-template-columns: 1fr; }
            .objective-item, .works-item { width: 45%; }
        }

        @media (max-width: 768px) {
            nav ul { display: none; flex-direction: column; position: absolute; top: 60px; left: 0; width: 100%; background: var(--bg-primary); padding: 15px 0; }
            nav ul.active { display: flex; }
            .menu-toggle { display: flex; }
            .hero-btns { flex-direction: column; gap: 15px; }
            .objective-item, .works-item { width: 100%; }
        }

        @media (max-width: 480px) {
            .hero h1 { font-size: 1.8rem; }
            .hero p { font-size: 0.9rem; }
            section h2 { font-size: 1.5rem; }
            #chatbot-box { width: 95vw; height: 85vh; }
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .typing-animation {
            display: flex;
            gap: 4px;
            padding: 8px;
        }

        .typing-dot {
            width: 8px;
            height: 8px;
            background: var(--brand-purple);
            border-radius: 50%;
            animation: typing 1s infinite ease-in-out;
        }

        .typing-dot:nth-child(2) { animation-delay: 0.2s; }
        .typing-dot:nth-child(3) { animation-delay: 0.4s; }

        @keyframes typing {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-6px); }
        }

        .footer {
            background: var(--bg-secondary);
            position: relative;
            width: 100%;
            padding: 4rem 0 0 0;
            margin-top: 0;
            overflow: hidden;
            z-index: 0;
        }

        .footer-social {
            display: flex;
            gap: 20px;
            justify-content: flex-start;
            margin-top: 1rem;
        }

        .footer-social a {
            color: var(--brand-purple);
            font-size: 1.5rem;
            text-decoration: none;
            transition: all 0.3s ease;
        }

        .footer-social a:hover {
            color: var(--cta-yellow);
            transform: scale(1.2);
        }

        .footer-content {
            display: grid;
            grid-template-columns: 2fr 2fr 1.5fr;
            gap: 4rem;
            padding: 0 5%;
            position: relative;
            z-index: 4;
        }

        .footer-section {
            display: flex;
            flex-direction: column;
            gap: 1.5rem;
        }

        .footer-section h4 {
            font-family: 'Poppins', sans-serif;
            color: var(--brand-purple);
            font-size: 1.4rem;
            margin-bottom: 1rem;
        }

        .footer-links-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 2rem;
        }

        .footer-links-column h5 {
            color: var(--brand-purple);
            margin-bottom: 1rem;
            font-size: 1.1rem;
        }

        .footer-links-column ul {
            list-style: none;
            padding: 0;
        }

        .footer-links-column ul li {
            margin-bottom: 0.8rem;
        }

        .footer-links-column ul a {
            color: var(--text-primary);
            text-decoration: none;
            transition: all 0.3s ease;
        }

        .footer-links-column ul a:hover {
            color: var(--cta-yellow);
            transform: translateX(5px);
        }

        .newsletter-form {
            display: flex;
            gap: 0.5rem;
        }

        .newsletter-form input {
            flex: 1;
            padding: 0.8rem;
            border-radius: 5px;
            border: 1px solid var(--bg-secondary);
            background: var(--bg-primary);
            color: var(--text-primary);
        }

        .newsletter-form button {
            padding: 0.8rem 1.5rem;
            border: none;
            border-radius: 5px;
            background: var(--brand-purple);
            color: var(--bg-primary);
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .newsletter-form button:hover {
            transform: translateY(-2px);
            background: var(--cta-yellow);
            color: var(--text-primary);
        }

        .footer-bottom {
            margin-top: 4rem;
            padding: 2rem 5%;
            border-top: 1px solid var(--bg-secondary);
            background: var(--bg-primary);
        }

        .footer-bottom-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 1rem;
        }

        .footer-bottom-links {
            display: flex;
            gap: 2rem;
        }

        .footer-bottom-links a {
            color: var(--text-primary);
            text-decoration: none;
            transition: color 0.3s ease;
        }

        .footer-bottom-links a:hover {
            color: var(--cta-yellow);
        }

        .developer-credit {
            color: var(--text-primary);
        }

        .developer-credit a {
            color: var(--brand-purple);
            text-decoration: none;
            transition: all 0.3s ease;
        }

        .developer-credit a:hover {
            color: var(--cta-yellow);
        }

        @media (max-width: 1024px) {
            .footer-content {
                grid-template-columns: 1fr 1fr;
            }
            .footer-section.brand {
                grid-column: 1 / -1;
            }
        }

        @media (max-width: 768px) {
            .footer-content {
                grid-template-columns: 1fr;
                gap: 3rem;
            }
            .footer-bottom-content {
                flex-direction: column;
                text-align: center;
            }
            .footer-bottom-links {
                flex-direction: column;
                gap: 1rem;
            }
        }

        #page-loader {
            position: fixed;
            top: 0;
            left: 0;
            width: 100vw;
            height: 100vh;
            background: var(--bg-primary);
            z-index: 9999;
            display: flex;
            justify-content: center;
            align-items: center;
            transition: opacity 0.5s ease;
        }

        #page-loader.hidden {
            opacity: 0;
            pointer-events: none;
        }

        .testimonials {
    padding: clamp(40px, 8vw, 60px) 5%;
    background: var(--bg-primary);
    text-align: center;
}

.testimonials h2 {
    font-family: 'Poppins', sans-serif;
    font-size: clamp(1.8rem, 5vw, 2.5rem);
    color: var(--brand-purple);
    margin-bottom: 30px;
}

.testimonials-slider {
    position: relative;
    max-width: 1200px;
    margin: 0 auto;
    overflow: hidden;
    padding: 20px 0;
}

.testimonials-slide {
    display: flex;
    transition: transform 0.5s ease;
    gap: 30px; /* Consistent gap between cards */
}

.testimonial-card {
    flex: 0 0 calc(50% - 15px); /* 50% width minus half the gap */
    min-width: 300px;
    max-width: 550px;
    background: var (--bg-secondary);
    border: 1px solid var(--bg-secondary);
    border-radius: 10px;
    padding: 25px;
    margin: 0; /* Remove margin, using gap instead */
    text-align: left;
    transition: transform 0.3s ease, box-shadow 0.3s ease;
    opacity: 1;
    visibility: visible;
}

.rating {
    color: var(--cta-yellow);
    font-size: 1rem;
    margin-bottom: 10px;
}

.testimonial-card .profile-pic {
    width: 50px;
    height: 50px;
    display: flex;
    align-items: center;
    justify-content: center;
    margin-bottom: 10px;
}

.testimonial-card .profile-pic img {
    width: 100%;
    height: 100%;
    object-fit: contain; /* Ensures the image fits without distortion */
    filter: none; /* Prevents any color changes from CSS filters */
}

.testimonial-card h3 {
    font-family: 'Poppins', sans-serif;
    font-size: clamp(1rem, 3vw, 1.2rem);
    color: var(--brand-purple);
    margin-bottom: 5px;
}

.testimonial-card p {
    font-family: 'Inter', sans-serif;
    font-size: clamp(0.8rem, 2vw, 0.9rem);
    color: var(--text-primary);
    margin-bottom: 10px;
    word-break: break-word; /* Ensures long words break properly */
    overflow-wrap: break-word; /* Handles long strings */
    max-height: none; /* Removes any height constraint */
}

.testimonial-card .author {
    font-style: italic;
    color: var(--text-primary);
}

.slider-buttons {
    display: flex;
    justify-content: center;
    gap: 20px;
    margin-top: 20px;
}

.slider-buttons button {
    padding: 10px;
    background: var(--brand-purple);
    color: var(--bg-primary);
    border: none;
    border-radius: 50%;
    font-size: 1.2rem;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    width: 40px;
    height: 40px;
    transition: background 0.3s ease;
}

.slider-buttons button:hover {
    background: var(--cta-yellow);
    color: var(--text-primary);
}

.slider-buttons button:disabled {
    background: var(--bg-secondary);
    cursor: not-allowed;
    color: var(--text-primary);
}

@media (max-width: 1024px) {
    .testimonial-card {
        min-width: 320px; /* Slight reduction for tablets */
    }
}

@media (max-width: 768px) {
    .testimonial-card {
        width: 100%; /* Adjusts to 1 card per slide on tablets and below */
        min-width: 300px;
    }
}

/* Update the CTA section styles */
.cta {
    position: relative;
    background: linear-gradient(135deg, var(--brand-purple), var(--accent-blue));
    padding: 8rem 0;
    margin-bottom: -2px; /* Prevent any gap */
    color: var(--bg-primary);
    overflow: hidden;
    z-index: 1;
}

/* Add a floating effect to the CTA form */
.cta-content {
    position: relative;
    z-index: 2;
    padding: 0 20px;
}

.cta-form {
    position: relative;
    background: rgba(255, 255, 255, 0.1);
    backdrop-filter: blur(10px);
    border: 1px solid rgba(255, 255, 255, 0.2);
    border-radius: 15px;
    padding: 2.5rem;
    max-width: 500px;
    margin: 2rem auto;
    box-shadow: 0 15px 35px rgba(0, 0, 0, 0.2);
    transform: translateY(0);
    transition: transform 0.3s ease, box-shadow 0.3s ease;
}

.cta-form:hover {
    transform: translateY(-5px);
    box-shadow: 0 20px 40px rgba(0, 0, 0, 0.3);
}

/* Improve wave separator */
.cta-wave {
    position: absolute;
    bottom: -2px; /* Ensure perfect connection */
    left: 0;
    width: 100%;
    overflow: hidden;
    line-height: 0;
    transform: rotate(180deg);
}

.cta-wave svg {
    position: relative;
    display: block;
    width: calc(100% + 1.3px);
    height: 120px; /* Increased height for more pronounced wave */
    fill: var(--bg-secondary);
}

/* Adjust footer top margin */
.footer {
    margin-top: 0;
    position: relative;
    z-index: 0;
}

/* Add responsive adjustments */
@media (max-width: 768px) {
    .cta {
        padding: 4rem 0;
    }

    .cta-form {
        margin: 1.5rem auto;
        padding: 1.5rem;
    }

    .prototype-badge {
        padding: 0.8rem 1.5rem;
        margin-bottom: 2rem;
    }
}

@keyframes float {
    0% {
        transform: perspective(1000px) rotateY(-10deg) translateY(0);
    }
    50% {
        transform: perspective(1000px) rotateY(-10deg) translateY(-20px);
    }
    100% {
        transform: perspective(1000px) rotateY(-10deg) translateY(0);
    }
}

@keyframes fadeInUp {
    from {
        opacity: 0;
        transform: translateY(20px);
    }
    to {
        opacity: 1;
        transform: translateY(0);
    }
}

/* Add specific delays for each message */
.preview-message:nth-child(1) {
    animation-delay: 1s;
}
.preview-message:nth-child(2) {
    animation-delay: 1.5s;
}
.preview-message:nth-child(3) {
    animation-delay: 2s;
}
/* Define keyframes properly */
@keyframes float {
    0% {
        opacity: 1;
        transform: perspective(1000px) rotateY(-10deg) translateY(0);
    }
    50% {
        opacity: 1;
        transform: perspective(1000px) rotateY(-10deg) translateY(-20px);
    }
    100% {
        opacity: 1;
        transform: perspective(1000px) rotateY(-10deg) translateY(0);
    }
}

@keyframes fadeInUp {
    from {
        opacity: 0;
        transform: translateY(20px);
    }
    to {
        opacity: 1;
        transform: translateY(0);
    }
}

/* Add hover effect */
#hero-chat-preview:hover {
    transform: translateY(-10px);
    box-shadow: 0 30px 50px rgba(0, 0, 0, 0.15);
}

/* Ensure mobile responsiveness */
@media (max-width: 768px) {
    #hero-chat-preview {
        max-width: 280px;
        margin: 2rem auto;
        transform: none;
        animation: fadeInUp 0.5s ease forwards;
        animation-delay: 0.5s;
    }

    #hero-chat-preview:hover {
        transform: translateY(-5px);
    }
}

@keyframes chatPreview {
    from {
        opacity: 0;
        transform: translateY(20px);
    }
    to {
        opacity: 1;
        transform: translateY(0);
    }
}

@keyframes floatUpDown {
    0%, 100% {
        transform: translateY(0);
        box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
    }
    50% {
        transform: translateY(-10px);
        box-shadow: 0 30px 50px rgba(0, 0, 0, 0.15);
    }
}

@keyframes messageAppear {
    from {
        opacity: 0;
        transform: translateY(10px);
    }
    to {
        opacity: 1;
        transform: translateY(0);
    }
}

#hero-chat-preview:hover {
    transform: translateY(-5px);
    box-shadow: 0 30px 60px rgba(93, 63, 211, 0.2);
    transition: all 0.3s ease;
}
    </style>
</head>
<body>
    <div id="page-loader">
        <div class="loader-content d-flex flex-column justify-content-center align-items-center">
            <div class="spinner-border text-primary mb-3" role="status" aria-hidden="true"></div>
            <span style="font-family: 'Poppins', sans-serif; font-size: clamp(1.2rem, 3vw, 1.5rem); color: var(--brand-purple);">Loading CONVERSA...</span>
        </div>
    </div>
    <div class="scroll-progress"></div>
    <header>
        <nav>
            <div class="logo">CONVERSA</div>
            <div class="menu-toggle" onclick="toggleMenu()">
                <div></div>
                <div></div>
                <div></div>
            </div>
            <ul>
                <li><a href="{% url 'chatbot_project:homepage' %}">Home</a></li>
                <li><a href="{% url 'chatbot_project:pricing' %}">Pricing</a></li>
                <li><a href="{% url 'admin_panel:dashboard' %}">Access Dashboard</a></li>
            </ul>
        </nav>
    </header>

    <section class="hero">
    <div class="hero-content">
        <h1>CONVERSA: A Smart Chatbot with Voice Interaction</h1>
        <p>Experience the future of customer support with our AI-driven voice chatbot. Seamlessly handle queries, identify leads, and provide instant assistance - all in one powerful solution.</p>
        <div class="hero-btns">
            <button onclick="openChatbotFullPage()">
                <i class="fas fa-robot"></i>
                Try CONVERSA
            </button>
            <button onclick="redirectToDashboard()">
                <i class="fas fa-chart-line"></i>
                View Dashboard
            </button>
        </div>
    </div>
    <div id="hero-chat-preview">
        <div class="preview-message message bot">
            <div class="message-icon bot"><i class="fas fa-robot"></i></div>
            <div class="message-content" data-timestamp="Now">
                👋 Hi! I'm CONVERSA, your AI assistant. How can I help you today?
            </div>
        </div>
        <div class="preview-message message user">
            <div class="message-content" data-timestamp="Now">
                Tell me about your voice features
            </div>
            <div class="message-icon"><i class="fas fa-user"></i></div>
        </div>
        <div class="preview-message message bot">
            <div class="message-icon bot"><i class="fas fa-robot"></i></div>
            <div class="message-content" data-timestamp="Now">
                🎤 I support natural voice interactions! Just click the microphone icon to start speaking...
            </div>
        </div>
    </div>
</section>

    <section class="overview">
        <h2>About This Project</h2>
        <p class="overview-summary">CONVERSA is a smart chatbot designed for real-time customer query handling with AI-driven voice interaction and lead identification.</p>
        <p class="overview-details" style="display: none;">This project leverages the Web Speech API for voice capabilities, a keyword-based FAQ system for dynamic responses, and an analytics dashboard to provide actionable business insights.</p>
        <button class="read-more" onclick="toggleOverviewDetails(this)">Read More</button>
    </section>

    <section class="objectives" id="objectives">
        <h2>Features</h2>
        <div class="objective-list">
            <div class="objective-item">
                <h3>Interactive Chatbot</h3>
                <p>Create a responsive chatbot that supports text and voice input for seamless user interaction.</p>
            </div>
            <div class="objective-item">
                <h3>Dynamic FAQs</h3>
                <p>Implement a database-driven FAQ system with parent-child relationships for detailed responses.</p>
            </div>
            <div class="objective-item">
                <h3>Analytics Dashboard</h3>
                <p>Visualize query data with an analytics dashboard, including lead insights to demonstrate business value.</p>
            </div>
            <div class="objective-item">
                <h3>Lead Identification</h3>
                <p>Detect engaged users using keyword-based rules to identify potential leads.</p>
            </div>
        </div>
    </section>

    <section class="how-it-works" id="how-it-works">
        <h2>How It Works</h2>
        <div class="how-it-works-grid">
            <div class="works-item">
                <i class="fas fa-microphone"></i>
                <h3>Voice or Text</h3>
                <p>Interact naturally using voice or text input, powered by Web Speech API.</p>
            </div>
            <div class="works-item">
                <i class="fas fa-question-circle"></i>
                <h3>Smart Responses</h3>
                <p>Get instant answers from a dynamic FAQ system built with Django.</p>
            </div>
            <div class="works-item">
                <i class="fas fa-chart-line"></i>
                <h3>Lead Insights</h3>
                <p>Identify potential customers with keyword-based analytics.</p>
            </div>
        </div>
    </section>

    <section class="why-conversa" id="why-conversa">
        <h2>Why CONVERSA</h2>
        <p>Born as a college project, CONVERSA blends sleek UI design with robust AI to redefine customer support, crafted through iterative testing and innovation.</p>
    </section>

    <section class="testimonials" id="testimonials">
        <h2>What Users Say</h2>
        <div class="testimonials-slider">
            <div class="testimonials-slide" id="testimonial-slide">
                <div class="testimonial-card female">
                    <div class="rating">★★★★★</div>
                    <div class="profile-pic"><img src="{% static 'images/female.png' %}" alt="Female Testimonial Icon" style="width: 50px; height: 50px;"></div>
                    <h3>E-commerce Boost</h3>
                    <p>"CONVERSA handles customer queries 24/7, saving us hours and boosting sales! This feature has streamlined our e-commerce operations, reducing response times by 50%. Highly recommended for busy retailers!"</p>
                    <div class="author">— Sarah, Online Retail Owner</div>
                </div>
                <div class="testimonial-card male">
                    <div class="rating">★★★★★</div>
                    <div class="profile-pic"><img src="{% static 'images/male.png' %}" alt="Male Testimonial Icon" style="width: 50px; height: 50px;"></div>
                    <h3>Tech Support Made Easy</h3>
                    <p>"The voice feature is a game-changer for quick support. Our team loves it. The voice integration reduced our support ticket resolution time by 30%, improving team efficiency significantly."</p>
                    <div class="author">— Mark, IT Manager</div>
                </div>
                <div class="testimonial-card female">
                    <div class="rating">★★★★★</div>
                    <div class="profile-pic"><img src="{% static 'images/female_2.png' %}" alt="Female Testimonial Icon" style="width: 50px; height: 50px;"></div>
                    <h3>Lead Generation</h3>
                    <p>"We identified 20% more leads with CONVERSA’s analytics. Highly recommend! The lead identification feature helped us convert 20% more leads into customers within a month."</p>
                    <div class="author">— Priya, Marketing Lead</div>
                </div>
                <div class="testimonial-card male">
                    <div class="rating">★★★★☆</div>
                    <div class="profile-pic"><img src="{% static 'images/male_2.png' %}" alt="Male Testimonial Icon" style="width: 50px; height: 50px;"></div>
                    <h3>Customer Engagement</h3>
                    <p>"Great tool for keeping customers engaged with quick responses. Engagement rates improved by 15% with CONVERSA’s quick response system, perfect for small businesses."</p>
                    <div class="author">— John, Small Business Owner</div>
                </div>
                <div class="testimonial-card female">
                    <div class="rating">★★★★★</div>
                    <div class="profile-pic"><img src="{% static 'images/female_3.png' %}" alt="Female Testimonial Icon" style="width: 50px; height: 50px;"></div>
                    <h3>Time Saver</h3>
                    <p>"Saved us significant time on support tickets with its automation. Automation cut our support workload by 40%, allowing us to focus on growth."</p>
                    <div class="author">— Lisa, Support Lead</div>
                </div>
                <div class="testimonial-card male">
                    <div class="rating">★★★★☆</div>
                    <div class="profile-pic"><img src="{% static 'images/male_3.png' %}" alt="Male Testimonial Icon" style="width: 50px; height: 50px;"></div>
                    <h3>Easy Setup</h3>
                    <p>"Setup was straightforward, and the analytics are insightful. The setup took less than an hour, and the analytics provided actionable insights immediately."</p>
                    <div class="author">— Tom, Tech Enthusiast</div>
                </div>
            </div>
        </div>
        <div class="slider-buttons">
            <button id="prevBtn" onclick="prevSlide()"><i class="fas fa-arrow-left"></i></button>
            <button id="nextBtn" onclick="nextSlide()"><i class="fas fa-arrow-right"></i></button>
        </div>
    </section>

    <section class="cta" id="cta">
    <div class="cta-content">
        <h2>Join CONVERSA's Future</h2>
        <p class="cta-description">Be part of the next generation of customer service. Get updates about new features, early access, and exclusive insights.</p>

        <div class="prototype-badge">
            <i class="fas fa-code"></i>
            Prototype in Development – Click the Chat Icon to Test!
        </div>

        <form class="cta-form" onsubmit="validateCTA(event)">
            <input type="email" placeholder="Enter your email address" aria-label="Email for updates" required>
            <button type="submit" aria-label="Join updates">Get Early Access</button>
        </form>
    </div>
</section>

    <div id="chatbot-widget">
        <i class="fas fa-comment"></i>
    </div>

    <div id="chatbot-box">
        <div class="chat-header">
            <span>Chat with <b>CONVERSA</b></span>
            <div>
                <button class="minimize-btn" onclick="minimizeChat()">–</button>
                <button class="close-btn" onclick="toggleChat()">✕</button>
            </div>
        </div>
        <div id="chat-messages" class="chat-messages"></div>
        <div class="input-container">
            <div class="input-box">
                <input type="text" id="user-input" placeholder="Type your query..." autofocus>
                <button class="mic-btn" onclick="startVoiceRecognition()">
                    <i class="fas fa-microphone"></i>
                </button>
                <button class="send-btn" onclick="sendMessage()">Send</button>
            </div>
            <button class="faq-toggle" onclick="toggleFAQs()" aria-label="Toggle FAQs">Show FAQs</button>
            <div class="faq-buttons" id="faq-buttons">
                {% for faq in faqs %}
                    <button class="faq-btn" data-id="{{ faq.id }}" onclick="handleFAQClick('{{ faq.id }}')">{{ faq.question }}</button>
                {% empty %}
                    <p>No FAQs available. Please add some in the admin panel.</p>
                {% endfor %}
            </div>
        </div>
    </div>

    <footer class="footer">
        <div class="footer-content">
            <div class="footer-section brand">
                <h3 class="logo">CONVERSA</h3>
                <p class="footer-description">Transforming customer service through AI-powered conversations. Experience the future of customer engagement.</p>
                <div class="footer-social">
                    <a href="https://github.com/yourusername" target="_blank" aria-label="GitHub">
                        <i class="fab fa-github"></i>
                    </a>
                    <a href="https://linkedin.com/in/yourusername" target="_blank" aria-label="LinkedIn">
                        <i class="fab fa-linkedin"></i>
                    </a>
                    <a href="https://twitter.com/yourusername" target="_blank" aria-label="Twitter">
                        <i class="fab fa-twitter"></i>
                    </a>
                </div>
            </div>
            <div class="footer-section navigation">
                <h4>Navigation</h4>
                <div class="footer-links-grid">
                    <div class="footer-links-column">
                        <h5>Product</h5>
                        <ul>
                            <li><a href="#objectives">Features</a></li>
                            <li><a href="{% url 'chatbot_project:pricing' %}">Pricing</a></li>
                            <li><a href="#how-it-works">How It Works</a></li>
                        </ul>
                    </div>
                    <div class="footer-links-column">
                        <h5>Company</h5>
                        <ul>
                            <li><a href="#why-conversa">About</a></li>
                            <li><a href="#contact">Contact</a></li>
                            <li><a href="#careers">Careers</a></li>
                        </ul>
                    </div>
                </div>
            </div>
            <div class="footer-section contact">
                <h4>Get in Touch</h4>
                <div class="contact-info">
                    <p><i class="fas fa-envelope"></i> contact@conversa.com</p>
                    <p><i class="fas fa-phone"></i> +1 (234) 567-890</p>
                    <p><i class="fas fa-map-marker-alt"></i> New York, NY 10012</p>
                </div>
                <div class="newsletter">
                    <h5>Subscribe to Newsletter</h5>
                    <div class="newsletter-form">
                        <input type="email" placeholder="Enter your email">
                        <button type="submit">Subscribe</button>
                    </div>
                </div>
            </div>
        </div>
        <div class="footer-bottom">
            <div class="footer-bottom-content">
                <p>© 2025 CONVERSA. All rights reserved.</p>
                <div class="footer-bottom-links">
                    <a href="/privacy">Privacy Policy</a>
                    <a href="/terms">Terms of Service</a>
                    <a href="/cookies">Cookie Policy</a>
                </div>
                <div class="developer-credit">
                    Developed by <a href="https://github.com/yourusername" target="_blank">Nisarg Vakharia</a>
                </div>
            </div>
        </div>
    </footer>

<script data-cfasync="false" src="/cdn-cgi/scripts/5c5dd728/cloudflare-static/email-decode.min.js"></script>
<script>
    // Define debounce function globally at the top
    function debounce(func, wait) {
        let timeout;
        return function (...args) {
            clearTimeout(timeout);
            timeout = setTimeout(() => func.apply(this, args), wait);
        };
    }

    // Define updateSlider function globally
    function updateSlider() {
        showSlide(slideIndex);
    }

    let currentUtterance = null;
    const initialFaqs = [
        {% for faq in faqs|slice:":4" %}
            { id: '{{ faq.id|safe }}', question: '{{ faq.question|escapejs|safe }}', hasChildren: {% if faq.children.exists %}true{% else %}false{% endif %}, answer: '{{ faq.answer|escapejs|safe }}'}{% if not forloop.last %},{% endif %}
        {% endfor %}
    ];
    let faqCache = [...initialFaqs];

    function getCookie(name) {
        let cookieValue = null;
        if (document.cookie && document.cookie !== '') {
            const cookies = document.cookie.split(';');
            for (let i = 0; i < cookies.length; i++) {
                const cookie = cookies[i].trim();
                if (cookie.substring(0, name.length + 1) === (name + '=')) {
                    cookieValue = decodeURIComponent(cookie.substring(name.length + 1));
                    break;
                }
            }
        }
        return cookieValue;
    }

    function toggleMenu() {
        document.querySelector("nav ul").classList.toggle("active");
    }

    function toggleChat() {
        const chatBox = document.getElementById('chatbot-box');
        const isActive = chatBox.classList.contains('active');
        if (!isActive) {
            chatBox.classList.add('active');
            chatBox.style.display = 'flex';
            anime({ targets: '#chatbot-box', translateY: [100, 0], opacity: [0, 1], duration: 500, easing: 'easeOutQuad' });
            if (!chatBox.querySelector('.message.bot')) {
                loadGreeting();
            }
        } else {
            anime({ targets: '#chatbot-box', translateY: [0, 100], opacity: [1, 0], duration: 500, easing: 'easeOutQuad', complete: () => {
                chatBox.classList.remove('active');
                chatBox.style.display = 'none';
            }});
        }
    }

    function openChatbotFullPage() {
        window.location.href = "{% url 'chatbot_project:chatbot_home' %}";
    }

    function redirectToDashboard() {
        const nextUrl = "/admin_panel/dashboard/";
        window.location.href = "{% url 'chatbot_auth:signup_signin' %}?next=" + encodeURIComponent(nextUrl);
    }

    function toggleOverviewDetails(button) {
        const details = document.querySelector('.overview-details');
        const isHidden = details.style.display === 'none' || details.style.display === '';
        if (isHidden) {
            details.style.display = 'block';
            details.style.opacity = 0;
            details.style.height = '0px';
            details.style.overflow = 'hidden';
            anime({
                targets: details,
                opacity: [0, 1],
                height: [0, details.scrollHeight + 'px'],
                scaleY: [0.95, 1],
                duration: 600,
                easing: 'easeInOutCubic',
                complete: function() {
                    details.style.height = 'auto';
                    details.style.overflow = 'visible';
                }
            });
            button.textContent = 'Read Less';
        } else {
            anime({
                targets: details,
                opacity: [1, 0],
                height: [details.scrollHeight + 'px', 0],
                scaleY: [1, 0.95],
                duration: 600,
                easing: 'easeInOutCubic',
                complete: function() {
                    details.style.display = 'none';
                    button.textContent = 'Read More';
                }
            });
        }
    }

    function validateCTA(event) {
        event.preventDefault();
        const emailInput = event.target.querySelector('input[type="email"]');
        const email = emailInput.value.trim();
        const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
        if (!emailRegex.test(email)) {
            alert('Please enter a valid email address.');
            return;
        }
        console.log('CTA subscription:', email);
        emailInput.value = '';
        alert('Thanks for joining!');
    }

    function toggleFAQs() {
        const faqButtons = document.getElementById('faq-buttons');
        const toggleBtn = document.querySelector('.faq-toggle');
        faqButtons.classList.toggle('active');
        toggleBtn.textContent = faqButtons.classList.contains('active') ? 'Hide FAQs' : 'Show FAQs';
    }

    function refreshFAQs() {
        fetch('/chatbot/get_faqs/?page=0&limit=4', {
            method: 'GET',
            headers: { "X-CSRFToken": getCookie('csrftoken'), "Content-Type": "application/json" }
        })
        .then(response => response.json())
        .then(data => {
            faqCache = data.faqs;
            const faqButtons = document.getElementById('faq-buttons');
            faqButtons.innerHTML = faqCache.length ? faqCache.map(faq =>
                `<button class="faq-btn" data-id="${faq.id}" onclick="handleFAQClick('${faq.id}')">${escapeHtml(faq.question)}</button>`
            ).join('') : '<p>No FAQs available. Please add some in the admin panel.</p>';
        })
        .catch(error => {
            console.error('Error refreshing FAQs:', error);
            document.getElementById('faq-buttons').innerHTML += `<div class="error-notice">Failed to refresh FAQs: ${error.message}</div>`;
        });
    }

    function handleFAQClick(faqId) {
        const faq = faqCache.find(f => f.id === faqId);
        if (!faq) return;
        let timestamp = new Date().toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' });
        let chatBox = document.getElementById("chat-messages");
        chatBox.innerHTML += `<div class="message user" data-timestamp="${timestamp}"><div class="message-content">${escapeHtml(faq.question)}</div><div class="message-icon"><i class="fas fa-user"></i></div></div>`;
        chatBox.scrollTop = chatBox.scrollHeight;
        const typingId = showTypingIndicator();
        fetch(`/chatbot/get_sub_faqs/${faqId}/`, {
            method: 'GET',
            headers: { "X-CSRFToken": getCookie('csrftoken'), "Content-Type": "application/json" }
        })
        .then(response => { if (!response.ok) throw new Error('Network response was not ok'); return response.json(); })
        .then(data => {
            removeTypingIndicator(typingId);
            let botTimestamp = new Date().toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' });
            let botMessage = document.createElement('div');
            botMessage.className = 'message bot';
            botMessage.setAttribute('data-timestamp', botTimestamp);
            let content = faq.answer ? escapeHtml(faq.answer) : 'Here are related questions:<br>';
            if (data.sub_faqs && data.sub_faqs.length > 0) {
                let childButtons = '<div class="child-faq-buttons">';
                data.sub_faqs.forEach(child => {
                    childButtons += `<button class="child-faq-btn" onclick="sendFAQMessage('${escapeHtml(child.question)}')">${escapeHtml(child.question)}</button>`;
                });
                childButtons += '</div>';
                content += childButtons;
            } else if (!faq.answer) {
                content = "No additional details available. Please type your query for more help.";
            }
            botMessage.innerHTML = `<div class="message-icon bot"><i class="fas fa-robot"></i></div><div class="message-content">${content}</div>`;
            chatBox.appendChild(botMessage);
            chatBox.scrollTop = chatBox.scrollHeight;
            anime({ targets: botMessage, opacity: [0, 1], translateY: [20, 0], duration: 500, easing: 'easeOutQuad' });
        })
        .catch(error => {
            removeTypingIndicator(typingId);
            chatBox.innerHTML += `<div class="message bot error" data-timestamp="${botTimestamp}"><div class="message-icon bot"><i class="fas fa-exclamation-triangle"></i></div><div class="message-content">Error loading FAQ details: ${error.message}</div></div>`;
            chatBox.scrollTop = chatBox.scrollHeight;
        });
    }

    function sendMessage(isVoice = false, retryCount = 0, maxRetries = 2) {
        const inputField = document.getElementById("user-input");
        const message = inputField.value.trim();
        if (!message && !isVoice) return;

        const chatBox = document.getElementById("chat-messages");
        const timestamp = new Date().toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' });
        if (message) {
            chatBox.innerHTML += `<div class="message user" data-timestamp="${timestamp}"><div class="message-content">${escapeHtml(message)}</div><div class="message-icon"><i class="fas fa-user"></i></div></div>`;
        }
        chatBox.scrollTop = chatBox.scrollHeight;
        inputField.value = '';

        const typingId = showTypingIndicator();
        fetch("/chatbot/get_response/", {
            method: "POST",
            headers: { "Content-Type": "application/json", "X-CSRFToken": getCookie('csrftoken') },
            body: JSON.stringify({ message: message || '', is_voice: isVoice })
        })
        .then(response => {
            if (!response.ok) {
                throw new Error(`HTTP error! status: ${response.status}`);
            }
            return response.json();
        })
        .then(data => {
            removeTypingIndicator(typingId);
            const botTimestamp = new Date().toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' });
            const botMessage = document.createElement('div');
            botMessage.className = 'message bot';
            botMessage.setAttribute('data-timestamp', botTimestamp);
            let contentForDisplay = '';
            let contentForSpeech = '';

            if (data.error) {
                contentForDisplay = escapeHtml(data.error || "Sorry, something went wrong. Please try again.");
                contentForSpeech = data.error || "Sorry, something went wrong. Please try again.";
            } else if (data.escalate) {
                contentForDisplay = escapeHtml(data.response || "It seems I couldn’t fully assist you.");
                contentForSpeech = data.response || "It seems I couldn’t fully assist you.";
                if (data.contact) {
                    contentForDisplay += `<br><i class="fas fa-phone"></i> <a href="tel:${data.contact.phone}" class="contact-link">${escapeHtml(data.contact.phone)}</a>`;
                    contentForDisplay += `<br><i class="fas fa-envelope"></i> <a href="mailto:${data.contact.email}" class="contact-link">${escapeHtml(data.contact.email)}</a>`;
                    contentForSpeech += " Contact us at " + data.contact.phone + " or " + data.contact.email;
                }
            } else if (data.sub_faqs && data.sub_faqs.length > 0) {
                contentForDisplay = escapeHtml(data.response || 'Here are related questions:') + '<br>';
                let childButtons = '<div class="child-faq-buttons">';
                data.sub_faqs.forEach(sub_faq => {
                    childButtons += `<button class="child-faq-btn" onclick="sendFAQMessage('${escapeHtml(sub_faq.question)}')">${escapeHtml(sub_faq.question)}</button>`;
                });
                childButtons += '</div>';
                contentForDisplay += childButtons;
                contentForSpeech = data.response || "Here are related questions";
            } else if (data.response) {
                contentForDisplay = escapeHtml(data.response);
                contentForSpeech = data.response;
            } else {
                contentForDisplay = escapeHtml("Sorry, I couldn't process your request.");
                contentForSpeech = "Sorry, I couldn't process your request.";
            }

            if (isVoice) speak(contentForSpeech);

            botMessage.innerHTML = `<div class="message-icon bot"><i class="fas fa-robot"></i></div><div class="message-content">${contentForDisplay}</div>`;
            chatBox.appendChild(botMessage);
            chatBox.scrollTop = chatBox.scrollHeight;
            anime({ targets: botMessage, opacity: [0, 1], translateY: [20, 0], duration: 500, easing: 'easeOutQuad' });
        })
        .catch(error => {
            removeTypingIndicator(typingId);
            if (retryCount < maxRetries && error.message.includes('500')) {
                console.warn(`Retrying sendMessage (attempt ${retryCount + 1}) for message: ${message}`);
                setTimeout(() => sendMessage(isVoice, retryCount + 1, maxRetries), 1000);
            } else {
                const botTimestamp = new Date().toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' });
                let errorMessage = `Sorry, I couldn't process your request. Please try again later.`;
                if (isVoice) speak(errorMessage);
                chatBox.innerHTML += `<div class="message bot error" data-timestamp="${botTimestamp}"><div class="message-icon bot"><i class="fas fa-exclamation-triangle"></i></div><div class="message-content">${errorMessage}<br><br>Contact support: <a href="tel:+1 (234) 567-890" class="contact-link">+1 (234) 567-890</a> | <a href="mailto:support@conversa.com" class="contact-link">support@conversa.com</a></div></div>`;
                chatBox.scrollTop = chatBox.scrollHeight;
                console.error(`sendMessage error: ${error.message}`);
            }
        });
    }

    function sendFAQMessage(question) {
        document.getElementById("user-input").value = question;
        sendMessage();
    }

    function showTypingIndicator() {
        const id = 'typing-' + Date.now();
        const chatBox = document.getElementById('chat-messages');
        const typingDiv = document.createElement('div');
        typingDiv.id = id;
        typingDiv.className = 'message bot';
        typingDiv.innerHTML = `<div class="message-icon bot"><i class="fas fa-robot"></i></div><div class="message-content"><div class="typing-animation"><div class="typing-dot"></div><div class="typing-dot"></div><div class="typing-dot"></div></div></div>`;
        chatBox.appendChild(typingDiv);
        chatBox.scrollTop = chatBox.scrollHeight;
        return id;
    }

    function removeTypingIndicator(id) {
        const element = document.getElementById(id);
        if (element) element.remove();
    }

    function escapeHtml(unsafe) {
        if (!unsafe) return '';
        return unsafe
            .replace(/&/g, "&amp;")
            .replace(/</g, "&lt;")
            .replace(/>/g, "&gt;")
            .replace(/"/g, "&quot;")
            .replace(/'/g, "&#39;");
    }

    function startVoiceRecognition() {
        const micBtn = document.querySelector('.mic-btn');
        const chatBox = document.getElementById("chat-messages");
        const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
        if (!SpeechRecognition) {
            chatBox.innerHTML += `<div class="message bot error" data-timestamp="${new Date().toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' })}"><div class="message-icon bot"><i class="fas fa-exclamation-triangle"></i></div><div class="message-content">Speech recognition not supported. Use Chrome or Edge.</div></div>`;
            chatBox.scrollTop = chatBox.scrollHeight;
            return;
        }

        const recognition = new SpeechRecognition();
        recognition.lang = 'en-US';
        recognition.interimResults = true;
        recognition.maxAlternatives = 1;
        recognition.onstart = () => {
            micBtn.classList.add('active', 'listening');
        };
        recognition.onresult = (event) => {
            const transcript = Array.from(event.results)
                .map(result => result[0].transcript)
                .join('');
            document.getElementById("user-input").value = transcript;
            if (event.results[event.results.length - 1].isFinal) {
                sendMessage(true);
            }
        };
        recognition.onerror = (event) => {
            micBtn.classList.remove('active', 'listening');
            chatBox.innerHTML += `<div class="message bot error" data-timestamp="${new Date().toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' })}"><div class="message-icon bot"><i class="fas fa-exclamation-triangle"></i></div><div class="message-content">Speech error: ${event.error}. Check mic permissions.</div></div>`;
            chatBox.scrollTop = chatBox.scrollHeight;
        };
        recognition.onend = () => {
            micBtn.classList.remove('active', 'listening');
        };
        try {
            recognition.start();
        } catch (error) {
            micBtn.classList.remove('active', 'listening');
            chatBox.innerHTML += `<div class="message bot error" data-timestamp="${new Date().toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' })}"><div class="message-icon bot"><i class="fas fa-exclamation-triangle"></i></div><div class="message-content">Failed to start voice: ${error.message}</div></div>`;
            chatBox.scrollTop = chatBox.scrollHeight;
        }
    }

    function speak(text) {
        const synth = window.speechSynthesis;
        if (!synth) {
            console.warn("Speech synthesis not supported.");
            return;
        }
        if (currentUtterance) synth.cancel();
        const cleanText = String(text).trim();
        currentUtterance = new SpeechSynthesisUtterance(cleanText);
        currentUtterance.lang = 'en-US';
        currentUtterance.rate = 1.0;
        currentUtterance.pitch = 1.0;
        currentUtterance.volume = 1.0;
        currentUtterance.onerror = (event) => console.error("Speech synthesis error:", event.error);
        currentUtterance.onend = () => { currentUtterance = null; };
        synth.speak(currentUtterance);
    }

    function minimizeChat() {
        const chatBox = document.getElementById('chatbot-box');
        chatBox.style.height = '50px';
        chatBox.querySelector('.chat-messages').style.display = 'none';
        chatBox.querySelector('.input-container').style.display = 'none';
        chatBox.querySelector('.minimize-btn').textContent = '+';
        chatBox.querySelector('.minimize-btn').onclick = maximizeChat;
    }

    function maximizeChat() {
        const chatBox = document.getElementById('chatbot-box');
        chatBox.style.height = '500px';
        chatBox.querySelector('.chat-messages').style.display = 'block';
        chatBox.querySelector('.input-container').style.display = 'block';
        chatBox.querySelector('.minimize-btn').textContent = '–';
        chatBox.querySelector('.minimize-btn').onclick = minimizeChat;
    }

    function getGreeting(username) {
        const hour = new Date().getHours();
        let timeGreeting;
        if (hour < 12) timeGreeting = "Good morning";
        else if (hour < 17) timeGreeting = "Good afternoon";
        else timeGreeting = "Good evening";
        return `${timeGreeting}, ${username}! How can I assist you today?`;
    }

    function loadGreeting(attempt = 1, maxAttempts = 3) {
        const chatBox = document.getElementById("chat-messages");
        chatBox.innerHTML = '';
        setTimeout(() => {
            fetch("/chatbot/check_authentication/", {
                method: "GET",
                headers: { "Content-Type": "application/json" }
            })
            .then(response => {
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
                return response.json();
            })
            .then(data => {
                const greeting = getGreeting(data.username);
                const timestamp = new Date().toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' });
                const welcomeDiv = document.createElement("div");
                welcomeDiv.className = "message bot greeting";
                welcomeDiv.setAttribute('data-timestamp', timestamp);
                welcomeDiv.innerHTML = `<div class="message-icon bot"><i class="fas fa-robot"></i></div><div class="message-content">${escapeHtml(greeting)} Click "Show FAQs" or ask me anything!</div>`;
                chatBox.appendChild(welcomeDiv);
                chatBox.scrollTop = chatBox.scrollHeight;
                anime({ targets: welcomeDiv, opacity: [0, 1], translateY: [20, 0], duration: 500, easing: 'easeOutQuad' });
                console.log(`Greeting loaded: ${greeting}`);
            })
            .catch(error => {
                console.error(`Error loading greeting (attempt ${attempt}):`, error);
                if (attempt < maxAttempts) {
                    loadGreeting(attempt + 1, maxAttempts);
                } else {
                    const greeting = getGreeting("Guest");
                    const timestamp = new Date().toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' });
                    const welcomeDiv = document.createElement("div");
                    welcomeDiv.className = "message bot greeting";
                    welcomeDiv.setAttribute('data-timestamp', timestamp);
                    welcomeDiv.innerHTML = `<div class="message-icon bot"><i class="fas fa-robot"></i></div><div class="message-content">${escapeHtml(greeting)} Click "Show FAQs" or ask me anything!</div>`;
                    chatBox.appendChild(welcomeDiv);
                    chatBox.scrollTop = chatBox.scrollHeight;
                    anime({ targets: welcomeDiv, opacity: [0, 1], translateY: [20, 0], duration: 500, easing: 'easeOutQuad' });
                    console.log('Fallback greeting loaded');
                }
            });
        }, attempt * 500);
    }

    let slideIndex = 0;

    function showSlide(index) {
        const slide = document.getElementById('testimonial-slide');
        if (!slide) return;

        const totalCards = slide.children.length;
        const cardsPerSlide = 2;
        const maxIndex = Math.ceil(totalCards / cardsPerSlide) - 1;

        const cardWidth = slide.querySelector('.testimonial-card').offsetWidth;
        const gap = 30;
        const slideWidth = (cardWidth + gap) * 2;

        slideIndex = Math.max(0, Math.min(index, maxIndex));
        slide.style.transform = `translateX(-${slideIndex * slideWidth}px)`;

        const prevBtn = document.getElementById('prevBtn');
        const nextBtn = document.getElementById('nextBtn');
        if (prevBtn && nextBtn) {
            prevBtn.disabled = slideIndex === 0;
            nextBtn.disabled = slideIndex >= maxIndex;
        }
    }

    function nextSlide() {
        const slide = document.getElementById('testimonial-slide');
        const totalCards = slide.children.length;
        const cardsPerSlide = 2;
        const maxIndex = Math.ceil(totalCards / cardsPerSlide) - 1;

        if (slideIndex < maxIndex) {
            slideIndex++;
            showSlide(slideIndex);
        }
    }

    function prevSlide() {
        if (slideIndex > 0) {
            slideIndex--;
            showSlide(slideIndex);
        }
    }

    document.addEventListener('DOMContentLoaded', () => {
        const chatBox = document.getElementById("chat-messages");
        const loader = document.getElementById('page-loader');

        function hideLoader() {
            loader.classList.add('hidden');
            setTimeout(() => loader.style.display = 'none', 500);
            document.body.style.visibility = 'visible';
        }

        try {
            // Load FAQs and images
            Promise.all([
                ...Array.from(document.querySelectorAll('img')).map(img => {
                    if (img.complete) return Promise.resolve();
                    return new Promise(resolve => {
                        img.onload = img.onerror = resolve;
                    });
                }),
                fetch('/chatbot/get_faqs/?page=0&limit=4', {
                    method: 'GET',
                    headers: { "X-CSRFToken": getCookie('csrftoken'), "Content-Type": "application/json" }
                }).then(response => response.json()).catch(err => console.error('FAQ fetch error:', err))
            ])
            .then(() => {
                hideLoader();
                showSlide(slideIndex);
            })
            .catch(error => {
                console.error('Loading error:', error);
                hideLoader();
            });

            setTimeout(hideLoader, 3000);
        } catch (error) {
            console.error('DOMContentLoaded error:', error);
            hideLoader();
        }

        window.addEventListener('scroll', debounce(() => {
            const scrollTop = window.scrollY;
            const docHeight = document.body.scrollHeight - window.innerHeight;
            const scrollPercent = (scrollTop / docHeight) * 100;
            document.querySelector('.scroll-progress').style.width = scrollPercent + '%';
        }, 16));

        window.addEventListener('resize', debounce(updateSlider, 200));

        document.querySelectorAll('a[href^="#"]').forEach(anchor => {
            anchor.addEventListener('click', function (e) {
                e.preventDefault();
                const targetId = this.getAttribute('href').slice(1);
                const targetElement = document.getElementById(targetId);
                if (targetElement) {
                    targetElement.scrollIntoView({
                        behavior: 'smooth',
                        block: 'start'
                    });
                }
            });
        });

        document.getElementById('chatbot-widget').addEventListener('click', (e) => {
            e.preventDefault();
            e.stopPropagation();
            toggleChat();
        });

        const animateSection = (selector, delay = 0) => {
            anime({ targets: selector, opacity: [0, 1], translateY: [50, 0], duration: 1000, delay, easing: 'easeOutQuad' });
        };
        animateSection('.hero h1');
        animateSection('.hero p', 200);
        animateSection('.hero-btns', 400);
        animateSection('#hero-chat-preview', 600);

        const observer = new IntersectionObserver((entries) => {
            entries.forEach(entry => {
                if (entry.isIntersecting) {
                    const targets = entry.target.querySelectorAll('.animate-target');
                    anime({
                        targets: targets,
                        opacity: [0, 1],
                        translateY: [50, 0],
                        duration: 1000,
                        delay: anime.stagger(200),
                        easing: 'easeOutQuad'
                    });
                    observer.unobserve(entry.target);
                }
            });
        }, { threshold: 0.25 });

        document.querySelectorAll('section').forEach(section => {
            section.querySelectorAll('h2, .overview-summary, .objective-item, .works-item, .why-conversa p, .cta p, .cta-form, .prototype-notice').forEach(el => el.classList.add('animate-target'));
            observer.observe(section);
        });

        document.getElementById("user-input").addEventListener("keypress", (e) => {
            if (e.key === "Enter") sendMessage();
        });

        setTimeout(() => {
            const chatPreview = document.getElementById('hero-chat-preview');
            const previewMessages = document.querySelectorAll('#hero-chat-preview .preview-message');
            if (chatPreview) {
                chatPreview.classList.add('loaded');
                previewMessages.forEach(msg => msg.classList.add('loaded'));
            }
        }, 2500);
    });
</script>
</body>
</html>